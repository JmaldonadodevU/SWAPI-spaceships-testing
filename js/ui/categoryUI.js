export const CategoryUI = {
    // Initialize the category title
    init() {
        if (!document.getElementById('category-title')) {
            const title = document.createElement('h2');
            title.id = 'category-title';
            
            const container = document.getElementById('ships-container');
            if (container && container.firstChild) {
                container.insertBefore(title, container.firstChild);
            } else if (container) {
                container.appendChild(title);
            }
        }
        
        // Añadir nuevos botones para las categorías nuevas si no existen
        this.addNewCategoryButtons();
    },
    
    // Añadir botones para las nuevas categorías
    addNewCategoryButtons() {
        const menu = document.querySelector('.menu');
        
        // Verificar si ya existen los botones
        if (!document.querySelector('.button[data-page="republic"]')) {
            const republicButton = this.createCategoryButton('republic', 
                '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 600 600" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M271.5 1.06203C234.248 4.88803 201.059 14.435 167.5 30.978C136.661 46.18 112.281 63.648 87.964 87.964C32.99 142.939 2.51897 213.518 0.308968 291C-1.16003 342.48 8.44297 386.786 30.978 432.5C46.18 463.339 63.648 487.719 87.964 512.036C142.939 567.01 213.518 597.481 291 599.691C321.653 600.566 346.797 597.831 375.532 590.496C414.31 580.598 455.769 559.762 488 533.973C501.455 523.207 523.207 501.455 533.973 488C562.897 451.851 584.142 407.249 593.401 363.235C596.297 349.471 599 330.78 599 324.525C599 322.101 599.45 319.84 600 319.5C600.613 319.121 601 311.137 601 298.882C601 287.882 600.616 279.119 600.147 279.409C599.679 279.699 599.015 276.013 598.672 271.218C597.209 250.727 590.655 221.182 582.533 198.468C576.149 180.617 561.916 152.184 551.262 136C539.077 117.491 528.008 103.936 512.036 87.964C465.45 41.378 409.222 13.15 342.5 2.85303C327.522 0.541034 286.615 -0.490966 271.5 1.06203ZM275 33.078C222.378 38.354 172.229 58.846 131.5 91.715C119.426 101.459 97.859 123.334 88.823 135C37.186 201.667 19.586 287.69 41.019 368.641C50.484 404.391 68.304 439.491 91.715 468.5C101.459 480.574 123.334 502.141 135 511.177C201.667 562.814 287.69 580.414 368.641 558.981C404.391 549.516 439.491 531.696 468.5 508.285C480.574 498.541 502.141 476.666 511.177 465C562.814 398.333 580.414 312.31 558.981 231.359C549.516 195.609 531.696 160.509 508.285 131.5C498.541 119.426 476.666 97.859 465 88.823C427.725 59.952 383.899 41.365 336.804 34.454C324.135 32.595 287.872 31.788 275 33.078ZM256.198 50.019C222.345 56.096 187.257 70.223 159.285 89.04C152.803 93.4 146.484 97.767 145.243 98.744L142.985 100.52L153.743 111.209L164.5 121.899L175.121 114.669C200.165 97.62 230.395 85.296 260 80.064L269.5 78.385L269.776 63.192C270.031 49.175 269.915 48.007 268.276 48.085C267.299 48.132 261.864 49.002 256.198 50.019ZM330.224 63.183L330.5 78.366L338.5 79.706C367.007 84.478 397.394 96.598 422.5 113.208C428.55 117.21 433.981 120.803 434.569 121.191C435.177 121.593 440.255 117.264 446.361 111.139L457.085 100.382L449.292 94.785C417.859 72.206 383.356 57.51 345.265 50.475C337.896 49.114 331.435 48 330.907 48C330.325 48 330.056 53.963 330.224 63.183ZM280 160.336V208.672L273.75 210.377C270.313 211.315 263.292 214.154 258.15 216.686L248.799 221.289L214.64 187.14L180.481 152.991L167.24 166.259C159.958 173.556 154 179.968 154 180.508C154 181.048 169.14 196.634 187.644 215.144L221.288 248.799L216.686 258.15C214.154 263.292 211.315 270.313 210.377 273.75L208.672 280H160.336H112V300V320H160.336H208.672L210.377 326.25C211.315 329.688 214.154 336.708 216.686 341.85L221.289 351.201L187.14 385.36L152.991 419.519L166.259 432.76C173.556 440.042 179.968 446 180.508 446C181.048 446 196.634 430.86 215.144 412.356L248.799 378.712L258.15 383.314C263.292 385.846 270.313 388.685 273.75 389.623L280 391.328V439.664V488H300H320V439.664V391.328L326.25 389.623C329.688 388.685 336.708 385.846 341.85 383.314L351.201 378.711L385.36 412.86L419.519 447.009L432.76 433.741C440.042 426.444 446 420.032 446 419.492C446 418.952 430.86 403.366 412.356 384.856L378.712 351.201L383.314 341.85C385.846 336.708 388.685 329.688 389.623 326.25L391.328 320H439.664H488V300V280H439.664H391.328L389.623 273.75C388.685 270.313 385.846 263.292 383.314 258.15L378.711 248.799L412.86 214.64L447.009 180.481L433.741 167.24C426.444 159.958 420.032 154 419.492 154C418.952 154 403.366 169.14 384.856 187.644L351.201 221.288L341.85 216.686C336.708 214.154 329.688 211.315 326.25 210.377L320 208.672V160.336V112H300H280V160.336ZM94.785 150.708C72.206 182.141 57.51 216.644 50.475 254.735C49.114 262.104 48 268.565 48 269.093C48 269.675 53.963 269.944 63.183 269.776L78.366 269.5L79.706 261.5C84.478 232.993 96.598 202.606 113.208 177.5C117.21 171.45 120.803 166.019 121.191 165.431C121.593 164.823 117.264 159.745 111.139 153.639L100.382 142.915L94.785 150.708ZM488.791 153.743L478.101 164.5L485.331 175.121C502.38 200.165 514.704 230.395 519.936 260L521.615 269.5L536.808 269.776C545.305 269.93 552 269.657 552 269.156C552 268.662 551.11 263.138 550.023 256.88C544.102 222.801 530.021 187.62 510.96 159.285C506.6 152.803 502.233 146.484 501.256 145.243L499.48 142.985L488.791 153.743ZM0.421968 300C0.421968 311.275 0.567968 315.887 0.745968 310.25C0.923968 304.613 0.923968 295.387 0.745968 289.75C0.567968 284.113 0.421968 288.725 0.421968 300ZM48 330.844C48 331.338 48.89 336.862 49.977 343.12C55.898 377.199 69.979 412.38 89.04 440.715C93.4 447.197 97.767 453.516 98.744 454.757L100.52 457.015L111.209 446.257L121.899 435.5L114.669 424.879C97.62 399.835 85.296 369.605 80.064 340L78.385 330.5L63.192 330.224C54.695 330.07 48 330.343 48 330.844ZM521.543 331.25C521.327 331.938 520.851 334.75 520.487 337.5C519.248 346.863 512.956 369.416 508.358 380.974C502.196 396.465 495.548 409.267 486.792 422.5C482.79 428.55 479.197 433.981 478.809 434.569C478.407 435.177 482.736 440.255 488.861 446.361L499.618 457.085L505.215 449.292C527.794 417.859 542.49 383.356 549.525 345.265C550.886 337.896 552 331.447 552 330.933C552 329.42 522.022 329.732 521.543 331.25ZM153.639 488.861L142.915 499.618L150.708 505.215C182.141 527.794 216.644 542.49 254.735 549.525C262.104 550.886 268.565 552 269.093 552C269.675 552 269.944 546.037 269.776 536.817L269.5 521.634L261.5 520.294C232.993 515.522 202.606 503.402 177.5 486.792C171.45 482.79 166.019 479.197 165.431 478.809C164.823 478.407 159.745 482.736 153.639 488.861ZM424.879 485.331C399.835 502.38 369.605 514.704 340 519.936L330.5 521.615L330.224 536.808C330.07 545.305 330.343 552 330.844 552C331.338 552 336.862 551.11 343.12 550.023C377.199 544.102 412.38 530.021 440.715 510.96C447.197 506.6 453.516 502.233 454.757 501.256L457.015 499.48L446.257 488.791L435.5 478.101L424.879 485.331Z" fill="white"/></svg>'
            );
            
            const separatistButton = this.createCategoryButton('separatist',
                '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 490 490" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M110.131 2.75C106.481 6.448 0 240.668 0 245C0 249.332 106.481 483.552 110.131 487.25L112.846 490H245H377.154L379.869 487.25C383.519 483.552 490 249.332 490 245C490 240.668 383.519 6.448 379.869 2.75L377.154 0H245H112.846L110.131 2.75ZM136.018 21.75C136.028 22.163 154.657 55.575 177.415 96L218.793 169.5H245H271.207L312.585 96C335.343 55.575 353.972 22.163 353.982 21.75C353.992 21.337 304.95 21 245 21C185.05 21 136.008 21.337 136.018 21.75ZM73.579 131.75C49.426 184.963 29.054 229.738 28.307 231.25L26.949 234H100.733H174.518L187.697 207.62L200.876 181.239L159.753 108.12C137.136 67.904 118.375 35 118.062 35C117.749 35 97.732 78.537 73.579 131.75ZM330.247 108.12L289.124 181.239L302.303 207.62L315.482 234H389.184H462.886L458.193 223.716C455.612 218.06 435.275 173.291 413 124.229C390.725 75.167 372.246 35.02 371.934 35.013C371.623 35.006 352.864 67.904 330.247 108.12ZM206.244 218.5L193.005 245L206.244 271.5L219.482 298H245H270.518L283.756 271.5L296.995 245L283.756 218.5L270.518 192H245H219.482L206.244 218.5ZM28.307 258.75C29.054 260.262 49.426 305.038 73.579 358.25C97.732 411.462 117.749 455 118.062 455C118.375 455 137.136 422.096 159.753 381.88L200.876 308.761L187.697 282.38L174.518 256H100.733H26.949L28.307 258.75ZM302.303 282.38L289.124 308.761L330.247 381.88C352.864 422.096 371.623 454.992 371.934 454.983C372.347 454.971 442.159 302.332 461.052 260.133L462.902 256H389.192H315.482L302.303 282.38ZM218.694 320.734C212.981 330.593 136.746 466.499 136.351 467.528C135.856 468.818 149.251 469 244.893 469C304.902 469 353.992 468.663 353.982 468.25C353.972 467.837 335.343 434.425 312.586 394L271.208 320.5L245.173 320.234C230.854 320.087 218.939 320.312 218.694 320.734Z" fill="white"/></svg>'
            );
            
            // Insertar los nuevos botones antes del último (favoritos)
            const favoritesButton = document.querySelector('.button[data-page="favorites"]');
            if (favoritesButton && menu) {
                menu.insertBefore(republicButton, favoritesButton);
                menu.insertBefore(separatistButton, favoritesButton);
            }
        }
    },
    
    // Crear un botón para una categoría
    createCategoryButton(category, icon) {
        const button = document.createElement('button');
        button.className = 'button';
        button.dataset.page = category;
        button.innerHTML = icon;
        
        // Añadir evento al botón
        button.addEventListener('click', () => {
            const event = new CustomEvent('loadCategory', { 
                detail: { category } 
            });
            document.dispatchEvent(event);
        });
        
        return button;
    },
    
    // Update UI based on category
    updateForCategory(category) {
        this.init();
        this.updateCategoryTitle(category);
        
        // Resetear todos los temas especiales primero
        this.resetTheme();
        
        // Special handling for categories
        switch(category) {
            case 'empire':
                document.body.classList.add('theme-empire');
                break;
            case 'republic':
                document.body.classList.add('theme-republic');
                break;
            case 'separatist':
                document.body.classList.add('theme-separatist');
                break;
            case 'rebellion':
                document.body.classList.add('theme-rebellion');
                break;
            case 'favorites':
                document.body.classList.add('theme-favorites');
                break;
            case 'dice':
                document.body.classList.add('theme-dice');
                this.applyRandomRotations();
                break;
            // Otros casos se manejan con resetTheme()
        }
    },
    
    // Update title text
    updateCategoryTitle(category) {
        const titleMap = {
            'home': 'Todas las Naves de Star Wars',
            'rebellion': 'Naves de la Alianza Rebelde',
            'empire': 'Naves del Imperio Galáctico',
            'republic': 'Naves de la República Galáctica',
            'separatist': 'Naves de la Alianza Separatista',
            'dice': 'Naves Aleatorias',
            'favorites': 'Mis Naves Favoritas'
        };
        
        const title = document.getElementById('category-title');
        if (title) {
            title.textContent = titleMap[category] || titleMap.home;
        }
    },
    
    // Reset to default theme
    resetTheme() {
        // Eliminar todas las clases de tema
        document.body.classList.remove('theme-empire', 'theme-republic', 'theme-separatist', 'theme-rebellion', 'theme-favorites', 'theme-dice', 'empire-theme');
    },
    
    // Aplicar rotaciones aleatorias a las tarjetas en el modo dado
    applyRandomRotations() {
        // Esta función ahora está vacía para mantener las tarjetas rectas
        // como solicitó el usuario
    }
};